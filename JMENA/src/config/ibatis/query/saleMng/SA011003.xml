<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
  "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="SA011003">
	<typeAlias alias="SA011003VO" type="kr.co.jmena.www.web.home.saleMng.Vo.SA011003VO"/>

	<resultMap id="SA011003Data" class="SA011003VO">
		<result property="IPGUMDATE" 	column="IPGUMDATE"/>
		<result property="IPGUMID" 		column="IPGUMID"/>
		<result property="IPGUMTYPE" 	column="IPGUMTYPE"/>
		<result property="IPGUMGUBUN" 	column="IPGUMGUBUN"/>
		<result property="BANKGUBUN" 	column="BANKGUBUN"/>
		<result property="IPGUMPERSON" 	column="IPGUMPERSON"/>
		<result property="IPGUMAMT" 	column="IPGUMAMT"/>
		<result property="SUGUMAMT" 	column="SUGUMAMT"/>
		<result property="JANAMT" 		column="JANAMT"/>
		<result property="BRANCHNAME" 	column="BRANCHNAME"/>
		<result property="KNAME" 		column="KNAME"/>
		<result property="ADDRESS" 		column="ADDRESS"/>
		<result property="CONNAME" 		column="CONNAME"/>
		<result property="CONPY" 		column="CONPY"/>
		<result property="REMARK" 		column="REMARK"/>
	</resultMap>

	<select id="selectListEnaIpgumMst" resultMap="SA011003Data">
		select 
			t1.ipgumdate,
			t1.ipgumid,
			t1.ipgumtype,
			t1.ipgumgubun,
			t1.bankgubun,
			t1.ipgumperson,
			t1.ipgumamt,
			(select sum(sugumamt) from sa_ipgumdtl where ipgumid = t1.ipgumid) as sugumamt,
			(t1.ipgumamt - (select sum(sugumamt) from sa_ipgumdtl where ipgumid = t1.ipgumid)) as janamt,
			(select branchname from ba_branchmst where branchcode = t1.branchcode) as branchname,
			(select kname from hr_insamst where insacode = t1.salercd) as kname,
			t1.address,
			t1.conname,
			t1.conpy,
			t1.remark
		from sa_ipgummst t1
		where 1=1
		<isNotEmpty property="IPGUMID">
			and t1.ipgumid = #IPGUMID#
		</isNotEmpty>
		<isNotEmpty property="SL_KNAME">
			and t1.salercd = #SL_KNAME#
		</isNotEmpty>
		<isNotEmpty property="SL_IPGUMDATE_FR">
			<isNotEmpty property="SL_IPGUMDATE_TO">
				and t1.ipgumdate between #SL_IPGUMDATE_FR# and #SL_IPGUMDATE_TO# 
			</isNotEmpty>
		</isNotEmpty>
		<isNotEmpty property="SL_IPGUMGUBUN">
			and t1.ipgumgubun = #SL_IPGUMGUBUN#
		</isNotEmpty>
		<isNotEmpty property="SL_BANKGUBUN">
			and t1.bankgubun = #SL_BANKGUBUN#
		</isNotEmpty>
		<isNotEmpty property="SL_IPGUMAMT">
			and t1.ipgumamt like '%#SL_IPGUMAMT#%'
		</isNotEmpty>
		order by t1.ipgumid asc

	</select>
	

</sqlMap>