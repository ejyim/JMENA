<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
  "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="SA011002">
	<typeAlias alias="SA011002VO" type="kr.co.jmena.www.web.home.saleMng.Vo.SA011002VO"/>

	<resultMap id="SA011002Data" class="SA011002VO">
		<result property="SALEDATE" 			column="SALEDATE"/>
		<result property="SALEID" 				column="SALEID"/>
		<result property="SALERCD" 				column="SALERCD"/>
		<result property="BRANCHNAME" 			column="BRANCHNAME"/>
		<result property="CITYCODE" 			column="CITYCODE"/>
		<result property="MANAGENO" 			column="MANAGENO"/>
		<result property="ADDRESS" 				column="ADDRESS"/>
		<result property="BUYM2" 				column="BUYM2"/>
		<result property="JANM2" 				column="JANM2"/>
		<result property="BUYPY" 				column="BUYPY"/>
		<result property="JANPY" 				column="JANPY"/>
		<result property="CONNAME" 				column="CONNAME"/>
		<result property="CONJUMINID" 			column="CONJUMINID"/>
		<result property="CONTELNO" 			column="CONTELNO"/>
		<result property="CONADDRESS" 			column="CONADDRESS"/>
		<result property="CONM2" 				column="CONM2"/>
		<result property="CONPY" 				column="CONPY"/>
		<result property="BRROWTYPE" 			column="BRROWTYPE"/>
		<result property="BRROWAMT" 			column="BRROWAMT"/>
		<result property="BRROWPERIOD" 			column="BRROWPERIOD"/>
		<result property="PERIODGUBUN" 			column="PERIODGUBUN"/>
		<result property="PAYRATE" 				column="PAYRATE"/>
		<result property="PAYAMT" 				column="PAYAMT"/>
		<result property="PAYACCOUNT" 			column="PAYACCOUNT"/>
		<result property="PAYBANK" 				column="PAYBANK"/>
		<result property="PAYOWNER" 			column="PAYOWNER"/>
		<result property="BRROWDATE" 			column="BRROWDATE"/>
		<result property="EXPIREDATE" 			column="EXPIREDATE"/>
		<result property="EXTENDYN" 			column="EXTENDYN"/>
		<result property="EXTENDDATE" 			column="EXTENDDATE"/>
		<result property="CANCELYN" 			column="CANCELYN"/>
		<result property="CANCELDATE" 			column="CANCELDATE"/>
		<result property="REMARK" 				column="REMARK"/>
		<result property="JOINYN" 				column="JOINYN"/>
		<result property="REGYN" 				column="REGYN"/>
		<result property="REGDATE" 				column="REGDATE"/>
		
	</resultMap>

	<select id="selectListEnaSaleMst2" resultMap="SA011002Data">
		select
			t1.saledate,
			t1.saleid,
			t1.salercd,
			(select branchcode from hr_insamst where insacode = t1.salercd) as branchname,
			(select citycode from mm_buymst where buyid = t1.buyid) as citycode,
			(select manageno from mm_buymst where buyid = t1.buyid) as manageno,
			(select address from mm_buymst where buyid = t1.buyid) as address,
			(select buym2 from mm_buymst where buyid = t1.buyid) as buym2,
			((select buym2 from mm_buymst where buyid = t1.buyid) - t1.conm2) as janm2,
			(select buypy from mm_buymst where buyid = t1.buyid) as buypy,
			((select buypy from mm_buymst where buyid = t1.buyid) - t1.conpy) as janpy,
			t1.conname,
			t1.conjuminid,
			t1.contelno,
			t1.conaddress,
			t1.conm2,
			t1.conpy,
			(select brrowtype from sa_salebdtl where saleid = t1.saleid) as brrowtype,
			(select brrowamt from sa_salebdtl where saleid = t1.saleid) as brrowamt,
			(select brrowperiod from sa_salebdtl where saleid = t1.saleid) as brrowperiod,
			(select periodgubun from sa_salebdtl where saleid = t1.saleid) as periodgubun,
			(select payrate from sa_salebdtl where saleid = t1.saleid) as payrate,
			(select payamt from sa_salebdtl where saleid = t1.saleid) as payamt,
			(select payaccount from sa_salebdtl where saleid = t1.saleid) as payaccount,
			(select paybank from sa_salebdtl where saleid = t1.saleid) as paybank,
			(select payowner from sa_salebdtl where saleid = t1.saleid) as payowner,
			(select brrowdate from sa_salebdtl where saleid = t1.saleid) as brrowdate,
			(select expiredate from sa_salebdtl where saleid = t1.saleid) as expiredate,
			(select extendyn from sa_salebdtl where saleid = t1.saleid) as extendyn,
			(select extenddate from sa_salebdtl where saleid = t1.saleid) as extenddate,
			(select cancelyn from sa_salebdtl where saleid = t1.saleid) as cancelyn,
			(select canceldate from sa_salebdtl where saleid = t1.saleid) as canceldate,
			t1.remark,
			(select joinyn from sa_salebdtl where saleid = t1.saleid) as joinyn,
			(select regyn from sa_salebdtl where saleid = t1.saleid) as regyn,
			(select regdate from sa_salebdtl where saleid = t1.saleid) as regdate
		from sa_salemst t1,
		(select insacode, kname from hr_insamst where 1=1
		) t2
		where 1=1
		<isNotEmpty property="SL_SALEID">
			and t1.saleid = #SL_SALEID#
		</isNotEmpty>
		<isNotEmpty property="SL_KNAME">
			and t2.kname like '%#SL_KNAME#%'
		</isNotEmpty>
		and t1.salercd = t2.insacode
		<isNotEmpty property="SL_SALEDATE_FR">
			<isNotEmpty property="SL_SALEDATE_TO">
				and t1.saledate between #SL_SALEDATE_FR# and #SL_SALEDATE_TO# 
			</isNotEmpty>
		</isNotEmpty>
		<isNotEmpty property="SL_CONADDRESS">
			and t1.address like '%#SL_CONADDRESS#%'
		</isNotEmpty>
		order by t1.saledate
		
	</select>
	

</sqlMap>